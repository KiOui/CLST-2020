{% extends 'equestria/base.html' %}
{% load static %}

{% block title %}
    Equestria: {% if process.script == process.project.pipeline.fa_script %}FA status{% else %}G2P status{% endif %}
{% endblock %}

{% block header %}
    {% if process.script == process.project.pipeline.fa_script %}
        {% include 'equestria/header.html' with active="fa" %}
    {% else %}
        {% include 'equestria/header.html' with active="g2p" %}
    {% endif %}
{% endblock %}

{% block body %}
    <div class="container">
        <div class="row">
            <div class="col-md-7">
                <h1>{% if process.script == process.project.pipeline.fa_script %}Forced Alignment{% else %}G2P{% endif %} progress</h1>
                <p>Status: <span id="process-django-status" class="font-weight-bold"></span></p>
                {% if process.script == process.project.pipeline.fa_script %}
                    <div style="display: none;" class="btn btn-primary" id="process-continue-button"
                         onclick="update_and_callback_no_data('/api/v1/processes/settings/{{ process.project.id }}/{{ process.project.pipeline.g2p_script.id }}/configure-automatically', {}, try_g2p_start, method = 'POST')"
                    >Continue</div>
                {% else %}
                    <a href="{% url 'projects:cd_screen' project=process.project %}" style="display: none;" class="btn btn-primary" id="process-continue-button">Continue</a>
                {% endif %}
            </div>
            <div class="col-md-1">
            </div>
            <div class="col-md-4 rounded lighter padding">
                <h3>Console Output</h3>
                <div class="p-3">
                    <div id="console_output"></div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
    <script>
        let PROCESS_STATUS_URL = "{% url 'v1:process-retrieve' pk=process.pk %}";
        let project_id = '{{ project.id }}';
        {% if process.script == process.project.pipeline.fa_script %}
            let next_script_id = '{{ project.pipeline.g2p_script.id }}';
        {% endif %}
    </script>
    <script src="{% static "processes/js/process-update.js" %}"></script>
    <script src="{% static "processes/js/start-g2p-automatically.js" %}"></script>
{% endblock %}
